<!DOCTYPE html>
<html>
    <head>
        <meta charset = "UTF-8">
        <title>Etch-a-Sketch</title>
        <link rel = 'stylesheet' href = 'style.css'>
    </head>
    <body>
      <div class = 'banner'>Etch-a-Sketch-a</div> 

      <div class = 'game'><button id = 'new'>New Grid</button></div>

      <div id = 'container'></div>   
      
   </body>

      <script>
         
         function grid() {
            var dimensions = prompt('Choose a number between 1 and 100');

            while (dimensions > 100 || dimensions < 1){
               dimensions = prompt('Try to choose a number between 1 and 100');
               // this will stop the user from entering values that are not in the 
               // range [1,100]. 
            }; 
            
            console.log(dimensions)

            const container = document.querySelector('#container');

            const containerHeight = container.offsetHeight-8 ; 
            console.log(containerHeight);

            for (let i = 0; i < dimensions; i ++){
               const row = document.createElement('div');   
               for (let j = 0; j < dimensions; j++){
                  var box = document.createElement('div');
                  box.classList.add('box');
                  box.setAttribute('style', 'height:' + containerHeight/dimensions + 'px; width:' +  containerHeight/dimensions + 'px;');
                  row.appendChild(box);
               };

               row.classList.add('row');
               row.setAttribute('style', 'width:' +  containerHeight+ 'px; height:' + containerHeight/dimensions + 'px;');
               container.appendChild(row);
            }; 

            var boxes = Array.from(document.querySelectorAll('.box'));
            var rows = Array.from(document.querySelectorAll('.row'));
            function addEventListenerList(list){
               for (let i = 0; i < list.length; i++){
                  list[i].addEventListener('click', ()=>{
                     list[i].setAttribute('style', 'background-color: black; height:' + containerHeight/dimensions + 'px; width:' +  containerHeight/dimensions + 'px;');
                     for (let j = 0; j < list.length; j++ ){
                        list[j].addEventListener('mouseover', ()=>{
                           list[j].setAttribute('style', 'background-color: black; height:' + containerHeight/dimensions + 'px; width:' +  containerHeight/dimensions + 'px;');
                        });
                     };
                  });
               };
            };

            addEventListenerList(boxes);
            
            // try a recursive algorithm => works but after we click the button the nth time, 
            // the number of prompt appearances increase by 2^{n-1}. After the 2^{n+1}th time,
            // game works fine. The reason is that the 
         };

         var newGrid = document.querySelector('#new');
         newGrid.addEventListener('click', ()=>{
            var boxes = Array.from(document.querySelectorAll('.box'));
            var rows = Array.from(document.querySelectorAll('.row')); 
      
            // iteratively remove boxes and rows
               
               boxes.forEach((box)=>{
                  box.remove();
               });

               rows.forEach((row)=>{
                  row.remove();
               });
               grid();
            });

            grid(); 
            
            // next need to fix the hover method so that when you click and hover, the line is drawn.

     </script>
    
</html>  